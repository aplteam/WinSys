 R←Test_004(stopFlag batchFlag);v;i;windir;set;r;⎕TRAP
⍝ Test the ##.WinSys.GetWindowsDirectory
 R←∆Failed
 ⎕TRAP←(999 'C' '. ⍝ Deliberate error')(0 'N')

 v←##.WinSys.GetWindowsDirectory
 set←⊃⎕CMD'set'                                          ⍝ All env variables
 r←'windir'{(#.APLTreeUtils.Lowercase(⍴⍺)↑[1]⍵)∧.=⍺}set  ⍝ Row
 windir←{⍵↓⍨-+/∧\' '=⌽⍵}'windir='{(⍴⍺)↓⍵}set[r⍳1;]
 →FailsIf windir≢v

 R←∆OK
