 R←Test_ShellExec_005(stopFlag batchFlag);⎕TRAP;tfn;buffer
⍝ Exercise `##.WinSys.ShellExecute` with a more complex string as right argument.
 ⎕TRAP←(999 'C' '. ⍝ Deliberate error')(0 'N')
 R←T._Failed

 tfn←##.FilesAndDirs.GetTempFilename''
 →T.GoToTidyUp 0≠##.WinSys.ShellExecute'cmd.exe /C Dir >',tfn
 ⎕DL 0.2
 buffer←##.APLTreeUtils.ReadUtf8File tfn
 →T.GoToTidyUp 0∊⍴buffer

 R←T._OK

∆TidyUp:
 :Trap 0 ⋄ ⎕NDELETE tfn ⋄ :EndTrap
